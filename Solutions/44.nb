(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[      5360,        179]
NotebookOptionsPosition[      4589,        149]
NotebookOutlinePosition[      4946,        165]
CellTagsIndexPosition[      4903,        162]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["\<\
Pentagon numbers
Problem 44

Pentagonal numbers are generated by the formula, Pn = n (3 n \[Minus] 1)/2. \
The first ten pentagonal numbers are : 1, 5, 12, 22, 35, 51, 70, 92, 117, \
145, ...
It can be seen that P4 + P7 = 22 + 70 = 92 = P8.However, their difference, 70 \
\[Minus] 22 = 48, is not pentagonal.Find the pair of pentagonal numbers, Pj \
and Pk, for which their sum and difference are pentagonal and D = | Pk \
\[Minus] Pj | is minimised; what is the value of D?\
\>", "Text",
 CellChangeTimes->{{3.65675490993783*^9, 3.656754911542865*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"maxN", "=", "4000"}], ";"}]], "Input",
 CellChangeTimes->{{3.6567540894434767`*^9, 3.656754091800412*^9}, {
  3.656754436375251*^9, 3.6567544576640368`*^9}, {3.656754745301038*^9, 
  3.656754761234023*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"pentagonalNumbers", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"n", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"3", "n"}], "-", "1"}], ")"}], "/", "2"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"n", ",", "maxN"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.656754097559639*^9, 3.656754121423293*^9}}],

Cell["use hashtable to speed up", "Text",
 CellChangeTimes->{{3.656754638467897*^9, 3.656754642085182*^9}, {
  3.656754735563684*^9, 3.656754738242015*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"rls", "=", 
   RowBox[{"Dispatch", "@", 
    RowBox[{"Append", "[", 
     RowBox[{
      RowBox[{"Thread", "[", 
       RowBox[{"pentagonalNumbers", "\[Rule]", "True"}], "]"}], ",", 
      RowBox[{"_", "\[Rule]", "False"}]}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.656754612383403*^9, 3.656754636044175*^9}, {
  3.656754682333394*^9, 3.656754682547256*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"testPentagonal", "=", 
    RowBox[{
     RowBox[{"MemberQ", "[", 
      RowBox[{"pentagonalNumbers", ",", "#"}], "]"}], "&"}]}], ";"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.656754123502192*^9, 3.656754140568385*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"testPentagonal", "[", "n_", "]"}], ":=", 
  RowBox[{"n", "/.", "rls"}]}]], "Input",
 CellChangeTimes->{{3.656754685212956*^9, 3.656754697603776*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"testPentagonalPair", "[", 
   RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"testPentagonal", "[", 
    RowBox[{"a", "+", "b"}], "]"}], "&&", 
   RowBox[{"testPentagonal", "[", 
    RowBox[{"a", "-", "b"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6567542501073*^9, 3.656754288375691*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"resPenPair", "=", 
   RowBox[{"Cases", "[", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", "b"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"a", ",", "pentagonalNumbers"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"b", ",", "pentagonalNumbers"}], "}"}]}], "]"}], ",", "1"}],
       "]"}], ",", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a_", ",", "b_"}], "}"}], "/;", 
      RowBox[{"testPentagonalPair", "[", 
       RowBox[{"a", ",", "b"}], "]"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.656754307552318*^9, 3.6567543944905977`*^9}}],

Cell[CellGroupData[{

Cell[BoxData["resPenPair"], "Input",
 CellChangeTimes->{{3.656755082315456*^9, 3.656755085547702*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"7042750", ",", "1560090"}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.656755086223926*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"resPenPair", "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "1"}], "]"}], "]"}], "-", 
  RowBox[{"resPenPair", "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "2"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6567550899136*^9, 3.6567551083530893`*^9}}],

Cell[BoxData["5482660"], "Output",
 CellChangeTimes->{{3.656755093171933*^9, 3.656755108663114*^9}}]
}, Open  ]]
},
WindowSize->{808, 693},
WindowMargins->{{Automatic, 278}, {-175, Automatic}},
FrontEndVersion->"10.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (June 27, \
2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 563, 12, 163, "Text"],
Cell[1124, 34, 241, 5, 28, "Input"],
Cell[1368, 41, 393, 12, 28, "Input"],
Cell[1764, 55, 156, 2, 30, "Text"],
Cell[1923, 59, 403, 10, 28, "Input"],
Cell[2329, 71, 275, 8, 28, "Input"],
Cell[2607, 81, 184, 4, 28, "Input"],
Cell[2794, 87, 343, 9, 28, "Input"],
Cell[3140, 98, 725, 21, 63, "Input"],
Cell[CellGroupData[{
Cell[3890, 123, 102, 1, 28, "Input"],
Cell[3995, 126, 151, 4, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4183, 135, 287, 8, 28, "Input"],
Cell[4473, 145, 100, 1, 28, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
